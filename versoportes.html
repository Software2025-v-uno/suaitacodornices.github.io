<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Galer√≠a de Archivos - Drive</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #2ecc71 0%, #27ae60 50%, #1e8449 100%);
      color: #333;
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    header {
      text-align: center;
      padding: 30px 0;
      margin-bottom: 30px;
    }

    .logo {
      width: 180px;
      margin: 0 auto 20px;
      filter: drop-shadow(0 4px 6px rgba(0,0,0,0.2));
    }

    h1 {
      font-size: 36px;
      color: white;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      margin-bottom: 10px;
      font-weight: 700;
    }

    .subtitle {
      color: rgba(255,255,255,0.9);
      font-size: 18px;
      margin-top: 10px;
    }

    .search-section {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      margin-bottom: 30px;
      max-width: 800px;
      margin: 0 auto 30px;
    }

    .search-section h2 {
      color: #27ae60;
      font-size: 24px;
      margin-bottom: 15px;
      text-align: center;
    }

    .search-bar {
      width: 100%;
      padding: 15px;
      font-size: 16px;
      border: 2px solid #2ecc71;
      border-radius: 50px;
      outline: none;
      transition: all 0.3s;
    }

    .search-bar:focus {
      border-color: #27ae60;
      box-shadow: 0 0 15px rgba(46, 204, 113, 0.3);
    }

    .search-btn {
      background: linear-gradient(135deg, #2ecc71, #27ae60);
      color: white;
      border: none;
      padding: 12px 40px;
      font-size: 16px;
      border-radius: 50px;
      cursor: pointer;
      margin-top: 15px;
      transition: all 0.3s;
      display: block;
      margin: 15px auto 0;
      font-weight: 600;
      box-shadow: 0 4px 15px rgba(46, 204, 113, 0.4);
    }

    .search-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(46, 204, 113, 0.6);
    }

    .results-container {
      display: flex;
      gap: 30px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .section {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.15);
      flex: 1;
      min-width: 300px;
      max-width: 600px;
    }

    .section-title {
      color: #27ae60;
      font-size: 22px;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 3px solid #2ecc71;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .section-title i {
      font-size: 24px;
    }

    .files-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 15px;
      max-height: 600px;
      overflow-y: auto;
      padding-right: 8px;
    }

    .files-grid::-webkit-scrollbar {
      width: 8px;
    }

    .files-grid::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 10px;
    }

    .files-grid::-webkit-scrollbar-thumb {
      background: #2ecc71;
      border-radius: 10px;
    }

    .file-card {
      background: #f8f9fa;
      border: 2px solid #e9ecef;
      border-radius: 12px;
      padding: 15px;
      text-align: center;
      transition: all 0.3s;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }

    .file-card:hover {
      transform: translateY(-5px);
      border-color: #2ecc71;
      box-shadow: 0 8px 20px rgba(46, 204, 113, 0.3);
      background: linear-gradient(135deg, #f8f9fa, #e8f5e9);
    }

    .file-card img {
      width: 60px;
      height: 60px;
      object-fit: cover;
      margin-bottom: 10px;
      border-radius: 8px;
    }

    .file-icon {
      font-size: 40px;
      margin-bottom: 10px;
    }

    .file-name {
      font-size: 13px;
      color: #2c3e50;
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      display: block;
      margin-top: 8px;
    }

    .file-link {
      color: #27ae60;
      text-decoration: none;
      display: block;
      font-weight: 600;
      padding: 8px;
      border-radius: 8px;
      transition: all 0.3s;
    }

    .file-link:hover {
      background: #e8f5e9;
      color: #1e8449;
    }

    .no-results {
      text-align: center;
      padding: 40px 20px;
      color: #7f8c8d;
      font-size: 16px;
    }

    .no-results i {
      font-size: 48px;
      color: #bdc3c7;
      margin-bottom: 15px;
    }

    @media (max-width: 768px) {
      .results-container {
        flex-direction: column;
      }

      h1 {
        font-size: 28px;
      }

      .section {
        min-width: 100%;
      }

      .files-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      }
    }

    .loading {
      text-align: center;
      padding: 40px;
      color: white;
      font-size: 18px;
    }

    .spinner {
      border: 4px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top: 4px solid white;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 15px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <img src="logo.png" alt="Logo" class="logo">
      <h1>üìÅ Galer√≠a de Archivos Drive</h1>
      <p class="subtitle">Explora y descarga tus documentos e im√°genes organizados</p>
    </header>

    <div class="search-section">
      <h2>üîç Buscar Archivos</h2>
      <input type="text" id="searchBar" class="search-bar" placeholder="Buscar por nombre o palabras relacionadas...">
      <button onclick="buscar()" class="search-btn">Buscar Archivos</button>
    </div>

    <div class="results-container" id="resultsContainer">
      <div class="section">
        <h2 class="section-title">üñºÔ∏è Im√°genes</h2>
        <div class="files-grid" id="imagenesContainer">
          <div class="loading">
            <div class="spinner"></div>
            <p>Cargando im√°genes...</p>
          </div>
        </div>
      </div>

      <div class="section">
        <h2 class="section-title">üìÑ Documentos</h2>
        <div class="files-grid" id="documentosContainer">
          <div class="loading">
            <div class="spinner"></div>
            <p>Cargando documentos...</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ===== CONFIGURACI√ìN DE CONEXI√ìN A GOOGLE DRIVE =====
    const API_KEY = 'AIzaSyAvOMSt1riEy1J-cf0nedd-1R3GZAg3puU';
    const FOLDER_ID = '1V8kpKn5aAd1SP7V4RhRwuH4bEobCc0WR';

    // ===== SISTEMA DE SIN√ìNIMOS =====
    const sinonimos = {
      "historial": ["registro", "expediente", "historia"],
      "informe": ["reporte", "an√°lisis", "documento"],
      "balance": ["estado", "cuentas", "financiero"],
      "excel": ["hoja", "planilla", "c√°lculo", "spreadsheet"],
      "documento": ["archivo", "informe", "pdf"],
      "imagen": ["foto", "picture", "photo", "img"],
      "presentaci√≥n": ["ppt", "powerpoint", "diapositiva"]
    };

    // ===== CLASIFICACI√ìN DE ARCHIVOS =====
    function esImagen(nombre) {
      const extensionesImagen = ['.jpg', '.jpeg', '.png', '.gif', '.bmp', '.webp', '.svg', '.ico'];
      const ext = nombre.toLowerCase();
      return extensionesImagen.some(e => ext.endsWith(e));
    }

    function esDocumento(nombre) {
      const extensionesDoc = ['.pdf', '.doc', '.docx', '.xls', '.xlsx', '.ppt', '.pptx', '.txt', '.rtf', '.csv'];
      const ext = nombre.toLowerCase();
      return extensionesDoc.some(e => ext.endsWith(e));
    }

    // ===== OBTENER ICONO SEG√öN TIPO DE ARCHIVO =====
    function obtenerIcono(nombreArchivo) {
      const ext = nombreArchivo.toLowerCase();
      
      // Documentos
      if (ext.endsWith(".pdf")) return "üìÑ";
      if (ext.endsWith(".doc") || ext.endsWith(".docx")) return "üìù";
      if (ext.endsWith(".xls") || ext.endsWith(".xlsx")) return "üìä";
      if (ext.endsWith(".ppt") || ext.endsWith(".pptx")) return "üìΩÔ∏è";
      if (ext.endsWith(".txt")) return "üìÉ";
      if (ext.endsWith(".csv")) return "üìà";
      if (ext.endsWith(".rtf")) return "üìÑ";
      
      // Im√°genes
      if (ext.endsWith(".jpg") || ext.endsWith(".jpeg")) return "üñºÔ∏è";
      if (ext.endsWith(".png")) return "üñºÔ∏è";
      if (ext.endsWith(".gif")) return "üé¨";
      if (ext.endsWith(".bmp")) return "üñºÔ∏è";
      if (ext.endsWith(".webp")) return "üñºÔ∏è";
      if (ext.endsWith(".svg")) return "üé®";
      
      return "üìÅ";
    }

    // ===== BUSCAR ARCHIVOS =====
    async function buscar() {
      const query = document.getElementById("searchBar").value.toLowerCase();
      const imagenesContainer = document.getElementById("imagenesContainer");
      const documentosContainer = document.getElementById("documentosContainer");

      // Mostrar loading
      imagenesContainer.innerHTML = '<div class="loading"><div class="spinner"></div><p>Buscando...</p></div>';
      documentosContainer.innerHTML = '<div class="loading"><div class="spinner"></div><p>Buscando...</p></div>';

      try {
        const response = await fetch(
          `https://www.googleapis.com/drive/v3/files?q='${FOLDER_ID}'+in+parents&key=${API_KEY}&fields=files(id,name,mimeType)`
        );
        
        if (!response.ok) {
          throw new Error('Error al conectar con Google Drive');
        }

        const data = await response.json();
        const archivos = data.files || [];

        // Generar palabras relacionadas
        const palabrasRelacionadas = [query];
        for (let palabra in sinonimos) {
          if (query.includes(palabra)) {
            palabrasRelacionadas.push(...sinonimos[palabra]);
          }
        }

        // Filtrar resultados
        let resultados = archivos;
        if (query.trim() !== '') {
          resultados = archivos.filter(file => 
            palabrasRelacionadas.some(palabra => 
              file.name.toLowerCase().includes(palabra)
            )
          );
        }

        // Separar im√°genes y documentos
        const imagenes = resultados.filter(file => esImagen(file.name));
        const documentos = resultados.filter(file => esDocumento(file.name));

        // Mostrar im√°genes
        if (imagenes.length > 0) {
          imagenesContainer.innerHTML = '';
          imagenes.forEach(file => {
            const card = document.createElement("div");
            card.className = "file-card";
            
            const link = document.createElement("a");
            link.href = `https://drive.google.com/file/d/${file.id}/view?usp=drivesdk`;
            link.target = "_blank";
            link.className = "file-link";
            
            // Para im√°genes, mostrar preview si es posible
            if (file.name.toLowerCase().endsWith('.jpg') || file.name.toLowerCase().endsWith('.jpeg') || file.name.toLowerCase().endsWith('.png')) {
              link.innerHTML = `
                <img src="https://drive.google.com/thumbnail?id=${file.id}&sz=w200" 
                     onerror="this.src='image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\' width=\'60\' height=\'60\' viewBox=\'0 0 24 24\'><path fill=\'%232ecc71\' d=\'M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z\'/></svg>'" 
                     alt="${file.name}">
                <span class="file-name" title="${file.name}">${file.name}</span>
              `;
            } else {
              link.innerHTML = `
                <div class="file-icon">${obtenerIcono(file.name)}</div>
                <span class="file-name" title="${file.name}">${file.name}</span>
              `;
            }
            
            card.appendChild(link);
            imagenesContainer.appendChild(card);
          });
        } else {
          imagenesContainer.innerHTML = `
            <div class="no-results">
              <div>üñºÔ∏è</div>
              <p>No hay im√°genes disponibles</p>
            </div>
          `;
        }

        // Mostrar documentos
        if (documentos.length > 0) {
          documentosContainer.innerHTML = '';
          documentos.forEach(file => {
            const card = document.createElement("div");
            card.className = "file-card";
            
            const link = document.createElement("a");
            link.href = `https://drive.google.com/file/d/${file.id}/view?usp=drivesdk`;
            link.target = "_blank";
            link.className = "file-link";
            
            link.innerHTML = `
              <div class="file-icon">${obtenerIcono(file.name)}</div>
              <span class="file-name" title="${file.name}">${file.name}</span>
            `;
            
            card.appendChild(link);
            documentosContainer.appendChild(card);
          });
        } else {
          documentosContainer.innerHTML = `
            <div class="no-results">
              <div>üìÑ</div>
              <p>No hay documentos disponibles</p>
            </div>
          `;
        }

      } catch (error) {
        console.error('Error:', error);
        imagenesContainer.innerHTML = `
          <div class="no-results">
            <div>‚ö†Ô∏è</div>
            <p>Error al cargar archivos</p>
            <small>${error.message}</small>
          </div>
        `;
        documentosContainer.innerHTML = `
          <div class="no-results">
            <div>‚ö†Ô∏è</div>
            <p>Error al cargar archivos</p>
            <small>${error.message}</small>
          </div>
        `;
      }
    }

    // ===== CARGAR TODOS LOS ARCHIVOS AL INICIAR =====
    window.onload = function() {
      buscar();
    };

    // ===== PERMITIR B√öSQUEDA CON ENTER =====
    document.getElementById("searchBar").addEventListener("keypress", function(e) {
      if (e.key === "Enter") {
        buscar();
      }
    });
  </script>
</body>
</html>